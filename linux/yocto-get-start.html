<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yocto Get Start - Notes ...</title>

    <link rel="shortcut icon" href="/styles/images/favicon.jpg">
    <link rel="icon" href="/styles/images/favicon.jpg">

    <link rel="stylesheet" href="/assets/css/wordpress.css">
    <link rel="canonical" href="/linux/yocto-get-start.html">

    <link rel="stylesheet" href="/assets/prism/prism.css">
    <script src="/assets/prism/prism.js"></script>
    <script src="https://kit.fontawesome.com/45a69050db.js" crossorigin="anonymous"></script>

    <meta name="keywords" content="Yocto Get Start, Notes ..., 学而不思则罔;思而不学则殆;生命不止;折腾不休">
    <meta name="description" content="学而不思则罔;思而不学则殆;生命不止;折腾不休">
</head>

<body class="index">
    <header id="header" itemscope="" itemtype="https://schema.org/WPHeader">
    <div id="head-in">
        <div id="head-parallax" style="overflow: hidden; background-position: 0px 0px;">
            <div class="head-cover" style="transform: translate(0px, 0px);">
                <div class="info" itemscope="" itemtype="https://schema.org/Website">
                    <h1 id="sitename">
                        <a href="/" itemprop="url"><img src="/assets/images/logo.svg" alt="" width="150" height="150" class="onepoint" itemprop="image" sizes="(max-width: 150px) 100vw, 150px"><span itemprop="name about">Linux Ref</span></a>
                    </h1>
                    <meta itemprop="alternativeHeadline" content="Linux tutorials, settings etc.">
                </div>
                <!--/.info-->
            </div>
            <!--/.head-cover-->
        </div>
        <!--/#head-parallax-->
    </div>
</header>
    <div class="container">
        

<div itemprop="breadcrumb">
    <ol id="breadcrumb">
        <li>
            <i class="fas fa-home"></i>
            <a href="/">ホーム</a>
            <i class="arrow">&gt;</i>
        </li>
        
        
        
            
            
            





<li>

<i class="fas fa-folder-open"></i>
<a href="/category/linux/">Linux</a>

</li>

    </ol>
</div>
<!-- 
    <div>value of name listsize:1</div>
    <div>value of href listsize:1</div>
    <div>value of count:0</div>
    
    <div>value of i:0</div>
    
     -->
<div id="primary" class="clearfix">
    <main id="main">
        <article>
            <div id="core" class="grid">
                <div itemprop="mainEntityOfPage" id="mainEntity" class="post post-109 type-post status-publish format-standard has-post-thumbnail hentry category-server tag-debian tag-linux tag-omv tag-openmediavault tag-server tag-wordpress ja">
                    <header id="article-header">
                        <h1 class="entry-title" itemprop="headline name">Yocto Get Start</h1>
                    </header>
                    <div class="clearfix">
                        <p class="meta">
                            <i class="far fa-clock"></i>
                            <span class="date published">
                                <time class="entry-date updated" datetime="2018-02-08T12:26:49+09:00" itemprop="datePublished">
                                    08 Feb 2018
                                </time>
                            </span>
                            <i class="fas fa-redo-alt"></i>
                            <span class="date">
                                <meta itemprop="dateModified" content="2020-08-23T17:24:54+09:00">
                                DUMMY STRING
                            </span>
                        </p>
                        <div id="toc_container">
<span class="toc_title">Contents</span><input id="toc_toggle" type="checkbox" checked><label class="toc_toggle" for="toc_toggle"></label>
                            <ul id="" class="toc_list">
<li class=" toc-h1"><a href="#references">References</a></li>
<li class=" toc-h1"><a href="#change-kernel-itbs-rootfs-image">Change kernel itb’s rootfs image</a></li>
<li class=" toc-h1"><a href="#add-extra-package-to-rootfs-image">Add extra package to rootfs image</a></li>
<li class=" toc-h1">
<a href="#add-own-package-to-rootfs-image">Add own package to rootfs image</a>
<ul>
<li class=" toc-h2"><a href="#purporse">Purporse</a></li>
<li class=" toc-h2"><a href="#reference">reference:</a></li>
<li class=" toc-h2"><a href="#procedure">Procedure</a></li>
</ul>
</li>
<li class=" toc-h1">
<a href="#bitbake-options">Bitbake options</a>
<ul>
<li class=" toc-h2"><a href="#reference-1">reference</a></li>
<li class=" toc-h2"><a href="#basic-options">Basic options</a></li>
</ul>
</li>
</ul>
                        </div>
                        <ul id="markdown-toc">
  <li><a href="#references" id="markdown-toc-references">References</a></li>
  <li><a href="#change-kernel-itbs-rootfs-image" id="markdown-toc-change-kernel-itbs-rootfs-image">Change kernel itb’s rootfs image</a></li>
  <li><a href="#add-extra-package-to-rootfs-image" id="markdown-toc-add-extra-package-to-rootfs-image">Add extra package to rootfs image</a></li>
  <li>
<a href="#add-own-package-to-rootfs-image" id="markdown-toc-add-own-package-to-rootfs-image">Add own package to rootfs image</a>    <ul>
      <li><a href="#purporse" id="markdown-toc-purporse">Purporse</a></li>
      <li><a href="#reference" id="markdown-toc-reference">reference:</a></li>
      <li><a href="#procedure" id="markdown-toc-procedure">Procedure</a></li>
    </ul>
  </li>
  <li>
<a href="#bitbake-options" id="markdown-toc-bitbake-options">Bitbake options</a>    <ul>
      <li><a href="#reference-1" id="markdown-toc-reference-1">reference</a></li>
      <li><a href="#basic-options" id="markdown-toc-basic-options">Basic options</a></li>
    </ul>
  </li>
</ul>

<h1 id="references">References</h1>
<ul>
  <li><a href="http://www.embeddedlinux.org.cn/OEManual/index.html">OpenEmbedded User Manual</a></li>
</ul>

<h1 id="change-kernel-itbs-rootfs-image">Change kernel itb’s rootfs image</h1>

<p>Change ROOTFS_IMAGE variable below:</p>
<pre><code class="line-numbers">../sources/meta-freescale/recipes-fsl/images/fsl-image-kernelitb.bb
	ROOTFS_IMAGE ?= "fsl-image-core"
</code></pre>

<h1 id="add-extra-package-to-rootfs-image">Add extra package to rootfs image</h1>

<p>Change IMAGE_INSTALL_append variable below:</p>
<pre><code class="line-numbers">../sources/meta-freescale/recipes-fsl/images/fsl-image-core.bb
	IMAGE_INSTALL_append
</code></pre>

<h1 id="add-own-package-to-rootfs-image">Add own package to rootfs image</h1>

<h2 id="purporse">Purporse</h2>
<ul>
  <li>Add libptp to rootfs image.</li>
  <li>libptp’s source resides in github https://github.com/jrabbit/libptp-chdk.git</li>
  <li>Add some self developed program to roofs image</li>
</ul>

<h2 id="reference">reference:</h2>
<ul>
  <li><a href="https://wiki.yoctoproject.org/wiki/Building_your_own_recipes_from_first_principles">Yocto wiki</a></li>
</ul>

<h2 id="procedure">Procedure</h2>

<ol>
  <li>prepare a layer<br>
 There are two options
    <ol>
      <li>Placing a recipe in an existing layer</li>
      <li>Using a new layer for recipes<br>
 example layer struct:
        <pre><code class="line-numbers"> ├── conf
 │   └── layer.conf
 └── recipes-ptp
     └── libptp2
         ├── files
         │   └── configure.in.patch
         └── libptp2_1.2.0.bb
</code></pre>
        <p><code>layer.conf</code>’s contents:</p>
        <pre><code class="language-shell line-numbers"> # We have a conf and classes directory, add to BBPATH
 BBPATH .= ":${LAYERDIR}"
 # We have recipes-* directories, add to BBFILES
 BBFILES += "${LAYERDIR}/recipes-*/*/*.bb \
 ${LAYERDIR}/recipes-*/*/*.bbappend"
 BBFILE_COLLECTIONS += "xacti"
 BBFILE_PATTERN_xacti = "^${LAYERDIR}/"
 BBFILE_PRIORITY_xacti = "6"
</code></pre>
      </li>
    </ol>
  </li>
  <li>Build package<br>
There are two options too.
    <ol>
      <li>Build an example package based on a git repository commit<br>
 example of <code>&lt;package&gt;_&lt;version&gt;.bb</code> file
        <pre><code class="line-numbers"> #
 # This file was derived from the 'Hello World!' example recipe in the
 # Yocto Project Development Manual.
 #
 DESCRIPTION = "Simple helloworld application"
 SECTION = "examples"
 DEPENDS = ""
 LICENSE = "MIT"
 LIC_FILES_CHKSUM = "file://LICENSE;md5=96af5705d6f64a88e035781ef00e98a8"
 FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}-${PV}:"
 SRCREV = "4ec84957442182f36351f94c0626560ec3ffd487"
 SRC_URI = "git://github.com/DynamicDevices/bbexample.git"
 S = "${WORKDIR}/git"
 inherit autotools
 # The autotools configuration I am basing this on seems to have a problem with a race condition when parallel make is enabled
 PARALLEL_MAKE = ""
</code></pre>
      </li>
      <li>Build an example package based on a local source archive<br>
 example of <code>&lt;package&gt;_&lt;version&gt;.bb</code> file
        <pre><code class="line-numbers"> #
 # This file was derived from the 'Hello World!' example recipe in the
 # Yocto Project Development Manual.
 #
 DESCRIPTION = "Simple helloworld application"
 SECTION = "examples"
 DEPENDS = ""
 LICENSE = "MIT"
 LIC_FILES_CHKSUM = "file://LICENSE;md5=96af5705d6f64a88e035781ef00e98a8"
 FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}-${PV}:"
 SRC_URI = "https://github.com/DynamicDevices/bbexample/releases/download/v1.0/bbexample-${PV}.tar.gz"
 SRC_URI[md5sum] = "e15723f0d5ac710bbe788cd3a797bc44"
 SRC_URI[sha256sum] = "0b34eb133596348bb6f1a3ef5e05e4d5bf0c88062256affe768d8337d7cc8f83"
 # Make sure our source directory (for the build) matches the directory structure in the tarball
 S = "${WORKDIR}/bbexample-${PV}"
 inherit autotools
 # The autotools configuration I am basing this on seems to have a problem with a race condition when parallel make is enabled
 PARALLEL_MAKE = ""
</code></pre>
      </li>
      <li>Build an example package based on a remote source archive<br>
 example of <code>&lt;package&gt;_&lt;version&gt;.bb</code> file
        <pre><code class="line-numbers"> #
 # This file was derived from the 'Hello World!' example recipe in the
 # Yocto Project Development Manual.
 #
 DESCRIPTION = "Simple helloworld application"
 SECTION = "examples"
 DEPENDS = ""
 LICENSE = "MIT"
 LIC_FILES_CHKSUM = "file://LICENSE;md5=96af5705d6f64a88e035781ef00e98a8"
 FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}-${PV}:"
 SRC_URI = "https://github.com/DynamicDevices/bbexample/releases/download/v1.0/bbexample-${PV}.tar.gz"
 SRC_URI[md5sum] = "e15723f0d5ac710bbe788cd3a797bc44"
 SRC_URI[sha256sum] = "0b34eb133596348bb6f1a3ef5e05e4d5bf0c88062256affe768d8337d7cc8f83"
 # Make sure our source directory (for the build) matches the directory structure in the tarball
 S = "${WORKDIR}/bbexample-${PV}"
 inherit autotools
 # The autotools configuration I am basing this on seems to have a problem with a race condition when parallel make is enabled
 PARALLEL_MAKE = ""
</code></pre>
      </li>
    </ol>
  </li>
</ol>

<h1 id="bitbake-options">Bitbake options</h1>

<h2 id="reference-1">reference</h2>
<ul>
  <li><a href="http://wiki.kaeilos.com/index.php/Bitbake_options">Bitbake options wiki</a></li>
</ul>

<h2 id="basic-options">Basic options</h2>
<ul>
  <li>
<code>bitbake -e</code> <br>
  Displays the internal state of variables used by BitBake</li>
  <li>
<code>bitbake -c cleansstate &lt;pkgname&gt;</code> <br>
  Cleans up all the tasks state with regard to the given <pkgname> This option is frequently used during the development of new recipes</pkgname>
</li>
  <li>
<code>bitbake &lt;pkgname&gt; -c rebuild -f</code><br>
  Clean and build again a package</li>
  <li>
<code>bitbake -c CMD &lt;pkgname&gt;</code><br>
  Specify the task to execute. The exact options available depend on the metadata</li>
  <li>
<code>bitbake -c listtasks core-image-minimal</code>
    <pre><code class="line-numbers">do_build                       Default task for a recipe - depends on all other normal tasks required to 'build' a recipe
do_bundle_initramfs            Combines an initial ramdisk image and kernel together to form a single image
do_checkuri                    Validates the SRC_URI value
do_checkuriall                 Validates the SRC_URI value for all recipes required to build a target
do_clean                       Removes all output files for a target
do_cleanall                    Removes all output files, shared state cache, and downloaded source files for a target
do_cleansstate                 Removes all output files and shared state cache for a target
do_compile                     Compiles the source in the compilation directory
do_configure                   Configures the source by enabling and disabling any build-time and configuration options for the software being built
do_devshell                    Starts a shell with the environment set up for development/debugging
do_fetch                       Fetches the source code
do_fetchall                    Fetches all remote sources required to build a target
do_install                     Copies files from the compilation directory to a holding area
do_listtasks                   Lists all defined tasks for a target
do_package                     Analyzes the content of the holding area and splits it into subsets based on available packages and files
do_package_setscene            Analyzes the content of the holding area and splits it into subsets based on available packages and files (setscene version)
do_package_write_rpm           Creates the actual RPM packages and places them in the Package Feed area
do_package_write_rpm_setscene  Creates the actual RPM packages and places them in the Package Feed area (setscene version)
do_packagedata                 Creates package metadata used by the build system to generate the final packages
do_packagedata_setscene        Creates package metadata used by the build system to generate the final packages (setscene version)
do_patch                       Locates patch files and applies them to the source code
do_populate_lic                Writes license information for the recipe that is collected later when the image is constructed
do_populate_lic_setscene       Writes license information for the recipe that is collected later when the image is constructed (setscene version)
do_populate_sdk                Creates the file and directory structure for an installable SDK
do_populate_sysroot            Copies a subset of files installed by do_install into the sysroot in order to make them available to other recipes
do_populate_sysroot_setscene   Copies a subset of files installed by do_install into the sysroot in order to make them available to other recipes (setscene version)
do_rootfs                      Creates the root filesystem (file and directory structure) for an image
do_unpack                      Unpacks the source code into a working directory
</code></pre>
  </li>
</ul>


                    </div>
                </div>
            </div>
        </article>
    </main>
    <div id="sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar" style="min-height: 298px;">
    <div id="side">
        <aside>
            <div id="side-fixed">
                <div id="categories-4" class="widget widget_categories">
                    <h3 class="side-title">カテゴリー</h3>

                    
                    <ul>
                        
                        <li>
                            <a href="/category/linux">Linux(19)</a>
                            
                        </li>
                        
                        <li>
                            <a href="/category/shell">シェル(1)</a>
                            
                        </li>
                        
                        <li>
                            <a href="/category/network">ネットワーク(1)</a>
                            
                        </li>
                        
                        <li>
                            <a href="/category/site">Web関連(2)</a>
                            
                        </li>
                        
                        <li>
                            <a href="/category/subcat1">サブカテゴリ１(3)</a>
                            
                            <ul>
                                
                                <li>
                                    <a href="/category/subcat1/subcat2">subcat2(2)</a>
                                    
                                    <ul>
                                        
                                        <li>
                                            <a href="/category/subcat1/subcat2/subcat3">subcat3(1)</a>
                                            
                                        </li>
                                        
                                    </ul>
                                    
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                    </ul>
                </div>
                <div id="search-4" class="widget widget_search">
                    <h3 class="side-title">検索</h3>
                    <div id="search" itemscope="" itemtype="https://schema.org/WebSite">
                        <meta itemprop="url" content="https://linuxref.net/">
                        <form itemprop="potentialAction" itemscope="" itemtype="https://schema.org/SearchAction" method="get" class="search-form" action="https://linuxref.net/">
                            <meta itemprop="target" content="https://linuxref.net/?s={s}">
<label><input itemprop="query-input" type="search" class="search-field" placeholder="  サイト内検索" value="" name="s" title="サイト内検索" required=""></label><input type="submit" class="search-submit" value="検索">
                        </form>
                    </div>
                </div>
                <div id="search-4" class="widget widget_search">
                    <h3 class="side-title">Debug</h3>

                    <div>site.data.a(level):</div>
                    <div>site.data.b(level):</div>
                    <div>site.data.c(level):</div>
                    <div>site.data.d(level):</div>
                    <div>page.data[category]:linux</div>
                    <div>page.data[newdata]:</div>

                </div>
            </div>
        </aside>
    </div>
    <!--/#side-->
</div>
</div>
    </div>
    <div id="footer" itemscope="" itemtype="https://schema.org/WPFooter">
    <footer>
        <div id="copyright">
            <p class="copy">Copyright © <span itemprop="copyrightYear">2021</span> <span itemprop="copyrightHolder name">Jianing Bi</span> All Rights Reserved.</p>
        </div>
    </footer>
</div>
</body>

</html>
